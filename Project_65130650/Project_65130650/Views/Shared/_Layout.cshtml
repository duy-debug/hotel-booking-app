<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - My ASP.NET Application</title>
    @Styles.Render("~/Content/css")
    @RenderSection("Styles", required: false)
    @Scripts.Render("~/bundles/modernizr")
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <style>
        body.modal-open {
            overflow: hidden;
        }

        /* Modal shared styles */
        .auth-modal {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
        }

        .auth-modal.is-active {
            opacity: 1;
            pointer-events: auto;
        }

        .auth-modal_backdrop {
            position: absolute;
            inset: 0;
            background: rgba(15, 23, 42, 0.65);
            backdrop-filter: blur(6px);
        }

        .auth-modal_panel {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 640px;
        }

        .auth-modal_close {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: white;
            color: #0f172a;
            font-size: 18px;
            box-shadow: 0 10px 40px rgba(15, 23, 42, 0.15);
            cursor: pointer;
        }

        .auth-card {
            background: white;
            border-radius: 28px;
            padding: 42px;
            box-shadow: 0 40px 80px rgba(15, 23, 42, 0.12);
        }

        .auth-card_header {
            display: flex;
            align-items: center;
            gap: 18px;
            margin-bottom: 30px;
        }

            .auth-card_logo {
                width: 54px;
                height: 54px;
                border-radius: 14px;
                background: linear-gradient(135deg, #0d4ea6, #3da9fc);
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 24px;
            }

            .auth-card h1 {
                margin: 0;
                font-size: 22px;
                font-weight: 700;
                color: #0f172a;
            }

            .auth-card p {
                margin: 0;
                color: #64748b;
                font-size: 14px;
            }

            .btn-primary {
                background: #0d4ea6;
                color: white !important;
                border: none;
                border-radius: 12px;
                padding: 12px 24px;
                font-weight: 600;
                font-size: 15px;
                cursor: pointer;
                transition: all 0.2s ease;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
                box-shadow: 0 4px 12px rgba(13, 78, 166, 0.2);
            }

            .btn-primary:hover {
                background: #0b3f84;
                transform: translateY(-1px);
                box-shadow: 0 6px 16px rgba(13, 78, 166, 0.3);
            }

            .btn-ghost {
                background: #f1f5f9;
                color: #475569 !important;
                border: none;
                border-radius: 12px;
                padding: 12px 24px;
                font-weight: 600;
                font-size: 15px;
                cursor: pointer;
                transition: all 0.2s ease;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }

            .btn-ghost:hover {
                background: #e2e8f0;
                color: #0f172a !important;
            }

            .link-button {
                border: none;
                background: none;
                color: #0d4ea6;
                font-weight: 600;
                cursor: pointer;
                padding: 0;
                font-size: 14px;
            }

            .link-button:hover {
                text-decoration: underline;
            }

            .auth-validation {
                background: rgba(239, 68, 68, 0.05);
                border: 1px solid rgba(239, 68, 68, 0.2);
                border-radius: 12px;
                padding: 12px;
                margin-bottom: 20px;
                display: none;
            }

            .auth-validation ul {
                margin: 0;
                padding-left: 20px;
                color: #dc2626;
                font-size: 13px;
            }

            .form-group label {
                font-size: 13px;
                font-weight: 600;
                color: #334155;
                margin-bottom: 6px;
                display: block;
            }

            .form-control {
                width: 100%;
                border: 1.5px solid #e2e8f0;
                border-radius: 10px;
                padding: 10px 12px 10px 40px;
                font-size: 14px;
                transition: all 0.2s ease;
            }

            .form-control:focus {
                border-color: #0d4ea6;
                box-shadow: 0 0 0 3px rgba(13, 78, 166, 0.1);
                outline: none;
            }

            .input-wrapper {
                position: relative;
            }

            .input-icon {
                position: absolute;
                left: 14px;
                top: 50%;
                transform: translateY(-50%);
                color: #94a3b8;
                font-size: 14px;
            }

            .form-control:focus + .input-icon {
                color: #0d4ea6;
            }

            .field-validation-error {
                color: #ef4444;
                font-size: 11px;
                font-weight: 500;
                margin-top: 4px;
                display: block;
                line-height: 1.4;
            }

            .form-group {
                margin-bottom: 18px;
            }

        @@media (max-width: 768px) {
            .auth-card {
                padding: 28px;
            }   

            .auth-modal_close {
                top: 8px;
                right: 8px;
            }
        }

        /* Nav active state */
        .nav-link-active {
            color: #0ea5e9 !important; /* sky-500 */
            border-bottom-color: #0ea5e9 !important;
        }

        .user-dropdown-logout:hover {
            background-color: #fef2f2;
        }

        .user-dropdown-logout i {
            color: #ef4444 !important;
        }

        /* Sync Profile Style with Admin */
        .user-profile-container {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 6px 14px;
            border-radius: 999px;
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid #e2e8f0;
        }

        .user-profile-container:hover {
            background: #f0f9ff;
            border-color: #bae6fd;
        }

        .user-profile-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0d4ea6, #3da9fc);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(13, 78, 166, 0.15);
        }

        .user-profile-info {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }

        .user-profile-name {
            font-weight: 600;
            font-size: 13px;
            color: #1e293b;
        }

        .user-profile-role {
            font-size: 11px;
            color: #64748b;
        }

        .user-profile-chevron {
            font-size: 10px;
            color: #94a3b8;
            margin-left: 2px;
            transition: transform 0.3s ease;
        }

        .user-profile-container:hover .user-profile-chevron {
            transform: translateY(2px);
            color: #0d4ea6;
        }

        /* Professional Dropdown Box */
        .user-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            min-width: 220px;
            box-shadow: 0 20px 50px rgba(15, 23, 42, 0.1);
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            overflow: hidden;
        }

        .user-profile-container:hover .user-dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* Dropdown Items styling */
        .user-dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            font-size: 14px;
            color: #475569;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .user-dropdown-item:hover {
            background-color: #f8fafc;
            color: #0d4ea6;
        }

        .user-dropdown-item i {
            width: 20px;
            text-align: center;
            font-size: 16px;
            color: #94a3b8;
            transition: color 0.2s ease;
        }

        .user-dropdown-item:hover i {
            color: #0d4ea6;
        }

        .user-dropdown-divider {
            height: 1px;
            background-color: #f1f5f9;
            margin: 4px 0;
        }

        .user-dropdown-logout {
            color: #ef4444 !important;
        }

        .user-dropdown-logout:hover {
            background-color: #fef2f2;
        }

        .user-dropdown-logout i {
            color: #ef4444 !important;
        }
    </style>
 </head>
<body class="bg-white min-h-screen flex flex-col">
    <script>
        // Set user authentication status from server
        var isUserLoggedIn = @(Request.IsAuthenticated ? "true" : "false");
    </script>
    <header class="bg-white/80 backdrop-blur border-b border-slate-200 sticky top-0 z-50">
        <div class="w-[85%] max-w-none mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center py-3">
                <!-- Logo + title (trái) -->
                <div class="flex items-center gap-3">
                    <a href="@Url.Action("Index", "Home", new { area = "" })" class="inline-flex items-center">
                        <img src="~/Images/logo.png"
                             alt="Shearaton"
                             class="block h-12 w-auto" />
                    </a>
                </div>


                <!-- Menu giữa -->
                <nav class="hidden md:flex flex-1 justify-center items-center gap-6 text-sm font-medium text-slate-600">
                    <a href="~/Home/Index#hotel" class="nav-item pb-1 border-b-2 border-transparent hover:border-sky-500 hover:text-sky-500 transition-colors" data-scroll-target="#hotel">Khách Sạn</a>
                    <a href="~/Home/Index#rooms" class="nav-item pb-1 border-b-2 border-transparent hover:border-sky-500 hover:text-sky-500 transition-colors" data-scroll-target="#rooms">Phòng, Suite & Penthouse</a>
                    <a href="~/Home/Index#services" class="nav-item pb-1 border-b-2 border-transparent hover:border-sky-500 hover:text-sky-500 transition-colors" data-scroll-target="#services">Dịch Vụ</a>
                    <a href="~/Home/Index#location" class="nav-item pb-1 border-b-2 border-transparent hover:border-sky-500 hover:text-sky-500 transition-colors" data-scroll-target="#location">Vị Trí</a>
                    <a href="~/Home/Index#dining" class="nav-item pb-1 border-b-2 border-transparent hover:border-sky-500 hover:text-sky-500 transition-colors" data-scroll-target="#dining">Nhà Hàng & Quầy Bar</a>
                    <a href="~/Home/Index#events" class="nav-item pb-1 border-b-2 border-transparent hover:border-sky-500 hover:text-sky-500 transition-colors" data-scroll-target="#events">Sự Kiện & Sống Động</a>
                </nav>
                <!-- Nút auth bên phải -->
                <div class="hidden md:flex items-center gap-3 ml-4">
                    <!-- Thêm cụm "Xin chào!" -->
                    @if (Request.IsAuthenticated && Session["UserName"] != null)
                    {
                    <p class="text-sky-600 font-semibold">Xin chào!</p>
                        <div class="user-profile-container">
                            <div class="user-profile-avatar">
                                @Session["UserName"].ToString().Substring(0, 1).ToUpper()
                            </div>
                            <div class="user-profile-info">
                                <span class="user-profile-name">@Session["UserName"]</span>
                                <span class="user-profile-role">@Session["UserRole"]</span>
                            </div>
                            <i class="fas fa-chevron-down user-profile-chevron"></i>

                            <div class="user-dropdown-menu">
                                @if (Session["UserRole"]?.ToString() == "Quản trị")
                                {
                                    <a href="@Url.Action("Index", "Home65130650", new { area = "Admin" })" class="user-dropdown-item font-semibold text-sky-600">
                                        <i class="fas fa-user-shield text-sky-600"></i>
                                        <span>Quản trị hệ thống</span>
                                    </a>
                                }
                                else
                                {
                                    <a href="@Url.Action("Index", "Home65130650", new { area = "Customer" })" class="user-dropdown-item">
                                        <i class="fas fa-chart-line"></i>
                                        <span>Trang chủ</span>
                                    </a>
                                    <a href="@Url.Action("AccountManagement", "Home65130650", new { area = "Customer" })" class="user-dropdown-item">
                                        <i class="fas fa-user-circle"></i>
                                        <span>Thông tin cá nhân</span>
                                    </a>
                                    <a href="@Url.Action("MyBookings", "Home65130650", new { area = "Customer" })" class="user-dropdown-item">
                                        <i class="fas fa-calendar-alt"></i>
                                        <span>Đơn đặt phòng</span>
                                    </a>
                                    <a href="@Url.Action("Payment", "Home65130650", new { area = "Customer" })" class="user-dropdown-item">
                                        <i class="fas fa-credit-card"></i>
                                        <span>Thanh toán</span>
                                    </a>
                                    <a href="@Url.Action("Support", "Home65130650", new { area = "Customer" })" class="user-dropdown-item">
                                        <i class="fas fa-headset"></i>
                                        <span>Liên hệ hỗ trợ</span>
                                    </a>
                                }
                                <div class="user-dropdown-divider"></div>
                                <a href="@Url.Action("Logout", "Account65130650", new { area = "" })" class="user-dropdown-item user-dropdown-logout font-bold">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>Đăng xuất</span>
                                </a>
                            </div>
                        </div>
                    }
                    else
                    {
                        <button type="button"
                                class="px-3 py-1.5 text-sm font-medium text-slate-600 border border-sky-200 rounded-full hover:bg-sky-50 transition-colors"
                                data-open-modal="login">
                            Đăng nhập
                        </button>
                        <button type="button"
                                class="px-3 py-1.5 text-sm font-medium text-white bg-sky-500 rounded-full hover:bg-sky-600 shadow-sm transition-colors"
                                data-open-modal="register">
                            Đăng ký
                        </button>
                    }
                </div>
            </div>
        </div>
    </header>

    <main class="flex-1">
        <div class="w-[85%] mx-auto px-4 sm:px-6 lg:px-8 py-0">
            @RenderBody()
        </div>
    </main>

    @Html.Partial("~/Views/Account65130650/Login.cshtml", new Project_65130650.Models.Forms.LoginForm65130650())
    @Html.Partial("~/Views/Account65130650/Register.cshtml", new Project_65130650.Models.Forms.RegisterForm65130650())

    <footer class="landing-footer bg-slate-300 text-slate-600 reveal mt-16 relative overflow-hidden border-t border-slate-200">
    <!-- Subtle accent line -->
    <div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-sky-500/30 to-transparent"></div>
    
    <div class="max-w-[85%] mx-auto px-4 pt-16 pb-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-16">
            <!-- Brand Section -->
            <div class="space-y-6">
                <a href="#top" class="inline-block group transition-transform duration-300 hover:scale-105">
                    <img src="@Url.Content("~/Images/logo.png")" alt="Shearaton" class="h-10 w-auto" />
                </a>
                <p class="text-sm leading-relaxed text-slate-500">
                    Trải nghiệm tinh hoa nghỉ dưỡng tại tâm điểm vịnh biển Nha Trang. 
                    Chúng tôi cam kết mang đến những dịch vụ đẳng cấp quốc tế và sự tận tâm trong từng khoảnh khắc.
                </p>
                <div class="flex gap-4">
                    <a href="https://www.facebook.com/Sheraton" 
                       class="w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-600 hover:text-[#1877F2] hover:border-[#1877F2] hover:bg-blue-50 transition-all duration-300 shadow-sm active:scale-90"
                       title="Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.instagram.com/sheratonhotels/" 
                       class="w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-600 hover:text-[#E4405F] hover:border-[#E4405F] hover:bg-pink-50 transition-all duration-300 shadow-sm active:scale-90"
                       title="Instagram">
                        <i class="fab fa-instagram text-lg"></i>
                    </a>
                    <a href="https://twitter.com/sheratonhotels" 
                       class="w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-600 hover:text-[#1DA1F2] hover:border-[#1DA1F2] hover:bg-blue-50 transition-all duration-300 shadow-sm active:scale-90"
                       title="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://www.youtube.com/user/SheratonHotels" 
                       class="w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-600 hover:text-[#FF0000] hover:border-[#FF0000] hover:bg-red-50 transition-all duration-300 shadow-sm active:scale-90"
                       title="Youtube">
                        <i class="fab fa-youtube text-lg"></i>
                    </a>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="lg:ml-8">
                <h4 class="text-slate-900 text-xs font-bold uppercase tracking-[0.2em] mb-8">Khám phá</h4>
                <ul class="space-y-4 text-sm font-medium">
                    <li><a href="~/Home/Index#hotel" class="text-slate-500 hover:text-sky-600 transition-colors" data-scroll-target="#hotel">Về khách sạn</a></li>
                    <li><a href="~/Home/Index#rooms" class="text-slate-500 hover:text-sky-600 transition-colors" data-scroll-target="#rooms">Hạng phòng & Suite</a></li>
                    <li><a href="~/Home/Index#services" class="text-slate-500 hover:text-sky-600 transition-colors" data-scroll-target="#services">Dịch vụ & Tiện ích</a></li>
                    <li><a href="~/Home/Index#dining" class="text-slate-500 hover:text-sky-600 transition-colors" data-scroll-target="#dining">Nhà hàng & Quầy Bar</a></li>
                    <li><a href="~/Home/Index#events" class="text-slate-500 hover:text-sky-600 transition-colors" data-scroll-target="#events">Sự kiện & Hội nghị</a></li>
                </ul>
            </div>

            <!-- Contact info -->
            <div>
                <h4 class="text-slate-900 text-xs font-bold uppercase tracking-[0.2em] mb-8">Liên hệ</h4>
                <ul class="space-y-4 text-sm font-medium">
                    <li class="flex items-start gap-4">
                        <i class="fas fa-map-marker-alt text-sky-500 mt-1"></i>
                        <span class="text-slate-500">26-28 Trần Phú, Lộc Thọ, <br />Nha Trang, Khánh Hòa</span>
                    </li>
                    <li class="flex items-center gap-4">
                        <i class="fas fa-phone-alt text-sky-500"></i>
                        <span class="text-slate-500">+84 258 388 0000</span>
                    </li>
                    <li class="flex items-center gap-4">
                        <i class="fas fa-envelope text-sky-500"></i>
                        <span class="text-slate-500">reservations.nhatrang@sheraton.com</span>
                    </li>
                </ul>
            </div>

            <!-- Opening Hours -->
            <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm transition-all duration-300 hover:shadow-md">
                <h4 class="text-slate-900 text-xs font-bold uppercase tracking-[0.2em] mb-6">Thời gian hoạt động</h4>
                <ul class="space-y-4 text-xs font-medium">
                    <li class="flex justify-between items-center py-2 border-b border-slate-50">
                        <span class="text-slate-500">Nhà hàng</span>
                        <span class="text-slate-900">06:00 - 22:00</span>
                    </li>
                    <li class="flex justify-between items-center py-2 border-b border-slate-50">
                        <span class="text-slate-500">Spa & Wellness</span>
                        <span class="text-slate-900">08:00 - 21:00</span>
                    </li>
                    <li class="flex justify-between items-center py-2 border-b border-slate-50">
                        <span class="text-slate-500">Hồ bơi</span>
                        <span class="text-slate-900">06:00 - 19:00</span>
                    </li>
                    <li class="flex justify-between items-center py-2">
                        <span class="text-slate-500">Quầy Bar</span>
                        <span class="text-slate-900">10:00 - 24:00</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Bottom section -->
        <div class="pt-8 border-t border-slate-200 flex flex-col md:flex-row justify-between items-center gap-6 text-[10px] text-slate-400 uppercase tracking-[0.2em] font-bold">
            <p>&copy; @DateTime.Now.Year Shearaton Hotel Nha Trang. All rights reserved.</p>
            <div class="flex gap-8">
            </div>
        </div>
    </div>
</footer>

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    <script>
        (function () {
            var body = document.body;

            // Đóng tất cả modal
            function closeAllModals() {
                var allModals = document.querySelectorAll('.auth-modal');
                allModals.forEach(function (modal) {
                    modal.classList.remove('is-active');
                    modal.setAttribute('aria-hidden', 'true');
                });
                body.classList.remove('modal-open');
            }

            // Mở modal theo tên
            function openModal(target) {
                // Đóng tất cả modal trước
                closeAllModals();
                
                var modal = document.getElementById(target + 'Modal');
                if (!modal) return;

                // Mở modal mới
                modal.classList.add('is-active');
                modal.setAttribute('aria-hidden', 'false');
                body.classList.add('modal-open');

                // Focus vào input đầu tiên
                setTimeout(function() {
                    var firstInput = modal.querySelector('input:not([type="hidden"])');
                    if (firstInput) firstInput.focus();
                }, 100);
            }

            // Expose openModal to global scope for use in other scripts
            window.openModal = openModal;

            // Xử lý click
            document.addEventListener('click', function (e) {
                // Mở modal (từ button header hoặc link trong modal)
                var openBtn = e.target.closest('[data-open-modal]');
                if (openBtn) {
                    e.preventDefault();
                    var target = openBtn.getAttribute('data-open-modal');
                    openModal(target);
                    return;
                }

                // Đóng modal (nút X hoặc click backdrop)
                var closeBtn = e.target.closest('[data-modal-close]');
                if (closeBtn) {
                    closeAllModals();
                }
            });

            // Đóng modal khi nhấn Escape
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') {
                    closeAllModals();
                }
            });
        })();

        // Smooth scroll for navbar links
        (function () {
            // Check if we're on the home page
            function isHomePage() {
                var path = window.location.pathname.toLowerCase();
                return path === '/' || path === '/home' || path === '/home/index' || path.endsWith('/');
            }

            // Scroll to hash on page load (if on home page)
            window.addEventListener('load', function() {
                if (isHomePage() && window.location.hash) {
                    setTimeout(function() {
                        var targetElement = document.querySelector(window.location.hash);
                        if (targetElement) {
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }, 100);
                }
            });

            // Handle navbar link clicks
            document.addEventListener('click', function (e) {
                var link = e.target.closest('[data-scroll-target]');
                if (link) {
                    e.preventDefault();
                    var targetSelector = link.getAttribute('data-scroll-target');
                    var href = link.getAttribute('href');
                    
                    // Update active state
                    document.querySelectorAll('.nav-item').forEach(l => l.classList.remove('nav-link-active'));
                    if (link.classList.contains('nav-item')) {
                        link.classList.add('nav-link-active');
                    }
                    
                    if (isHomePage()) {
                        // We're on home page, scroll directly
                        var targetElement = document.querySelector(targetSelector);
                        if (targetElement) {
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                            // Update URL hash without jumping
                            if (history.pushState) {
                                history.pushState(null, null, targetSelector);
                            }
                        }
                    } else {
                        // We're on another page, navigate to home with hash
                        if (href) {
                            window.location.href = href;
                        }
                    }
                }
            });

            // Set initial active state based on URL/Hash
            function updateActiveLink() {
                var path = window.location.pathname.toLowerCase();
                var hash = window.location.hash;
                
                // Clear all active
                document.querySelectorAll('.nav-item').forEach(l => l.classList.remove('nav-link-active'));

                // Handle Room list page specifically
                if (path.includes('/room65130650')) {
                    var roomLink = document.querySelector('.nav-item[data-scroll-target="#rooms"]');
                    if (roomLink) roomLink.classList.add('nav-link-active');
                    return;
                }

                // Handle sections on Home page via hash
                if (hash) {
                    document.querySelectorAll('.nav-item').forEach(l => {
                        if (l.getAttribute('data-scroll-target') === hash) {
                            l.classList.add('nav-link-active');
                        }
                    });
                }
            }
            updateActiveLink();
            window.addEventListener('hashchange', updateActiveLink);
            window.addEventListener('popstate', updateActiveLink);

            // ScrollSpy with IntersectionObserver
            if (isHomePage()) {
                const observerOptions = {
                    root: null,
                    rootMargin: '-20% 0px -70% 0px', 
                    threshold: 0
                };

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        // Only update if we don't have a hash-triggered active link (optional)
                        if (entry.isIntersecting) {
                            const id = '#' + entry.target.id;
                            document.querySelectorAll('.nav-item').forEach(link => {
                                if (link.getAttribute('data-scroll-target') === id) {
                                    link.classList.add('nav-link-active');
                                } else {
                                    link.classList.remove('nav-link-active');
                                }
                            });
                        }
                    });
                }, observerOptions);

                document.querySelectorAll('.nav-item').forEach(link => {
                    const targetId = link.getAttribute('data-scroll-target');
                    if (targetId && targetId.startsWith('#')) {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) observer.observe(targetElement);
                    }
                });
            }
        })();

        // Handle booking button clicks - check authentication
        (function () {
            document.addEventListener('click', function (e) {
                // 1. If it's a scroll button (like the Banner button), ignore authentication check
                // This allows the scroll script (above) to handle it
                if (e.target.closest('[data-scroll-target]')) {
                    return;
                }

                // Check if clicked element is a booking button
                var bookingBtn = e.target.closest('.btn-book, .btn-book-now');
                
                // Also check for btn-primary buttons with "Đặt phòng" text
                if (!bookingBtn) {
                    var primaryBtn = e.target.closest('.btn-primary');
                    if (primaryBtn && primaryBtn.textContent.includes('Đặt phòng')) {
                        bookingBtn = primaryBtn;
                    }
                }
                
                if (bookingBtn && !bookingBtn.disabled) {
                    e.preventDefault();
                    
                    if (typeof isUserLoggedIn !== 'undefined' && isUserLoggedIn) {
                         // Logic cho người đã đăng nhập (sẽ cập nhật sau khi bạn chốt phương án Modal hay Chuyển hướng)
                         // Hiện tại tạm để console log
                         console.log("Logged in user clicked booking");
                         // window.location.href = '@Url.Action("Index", "Home65130650", new { area = "Customer" })';
                    } else {
                        openModal('login');
                    }
                }
            });
        })();
    </script>
    @RenderSection("Scripts", required: false)
</body>
</html>
